angular.module("app",["ionic"]),angular.module("app").controller("TodoCtrl",["$scope","$timeout","$ionicModal","$ionicSideMenuDelegate","$ionicPopup","projectService",function(t,e,o,r,c,n){t.submitted=!1,t.project={title:""},t.task={title:""},t.projects=n.all(),t.activeProject=t.projects[n.getLastActiveIndex()],o.fromTemplateUrl("templates/new-project.html",function(e){t.projectModal=e},{scope:t,focusFirstInput:!0}),t.createProject=function(e){if(e){var o=n.newProject(e.title);t.projects.push(o),t.projectModal.hide(),n.save(t.projects),t.selectProject(o,t.projects.length-1),t.resetProjectForm()}},t.newProject=function(){t.projectModal.show()},t.closeNewProject=function(){t.projectModal.hide(),t.resetProjectForm()},t.resetProjectForm=function(){t.project={title:""},t.resetForm()},t.submitForm=function(){t.submitted=!0},t.resetForm=function(){t.submitted=!1},t.selectProject=function(e,o){t.activeProject=e,n.setLastActiveIndex(o),r.toggleLeft(!1)},o.fromTemplateUrl("templates/new-task.html",function(e){t.taskModal=e},{scope:t,focusFirstInput:!0}),t.createTask=function(e){t.activeProject&&e&&(t.activeProject.tasks.push({title:e.title}),t.taskModal.hide(),n.save(t.projects),t.resetTaskForm())},t.newTask=function(){t.taskModal.show()},t.closeNewTask=function(){t.taskModal.hide(),t.resetTaskForm()},t.resetTaskForm=function(){t.task={title:""},t.resetForm()},t.toggleProjects=function(){r.toggleLeft()},t.data={},e(function(){0==t.projects.length&&c.show({template:'<input type="text" ng-model="data.title">',title:"Enter Your First Project",scope:t,buttons:[{text:"<b>Create Project</b>",type:"button-positive",onTap:function(e){return t.data.title?void t.createProject({title:t.data.title}):void e.preventDefault()}}]})})}]),function(){function t(t){return{all:function(){var e=t.localStorage.projects;return e?angular.fromJson(e):[]},save:function(e){t.localStorage.projects=angular.toJson(e)},newProject:function(t){return{title:t,tasks:[]}},getLastActiveIndex:function(){return parseInt(t.localStorage.lastActiveProject)||0},setLastActiveIndex:function(e){t.localStorage.lastActiveProject=e}}}angular.module("app").factory("projectService",t),t.$inject=["$window"]}();