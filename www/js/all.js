angular.module("app",["ionic"]),angular.module("app").controller("TodoCtrl",["$scope","$timeout","$ionicModal","$ionicSideMenuDelegate","$ionicPopup","projectService",function(t,e,o,c,n,r){t.submitted=!1,t.project={title:""},t.task={title:""},t.projects=r.all(),t.activeProject=t.projects[r.getLastActiveIndex()],o.fromTemplateUrl("templates/new-project.html",function(e){t.projectModal=e},{scope:t,focusFirstInput:!0}),t.createProject=function(e){if(e){var o=r.newProject(e.title);t.projects.push(o),t.projectModal.hide(),r.save(t.projects),t.selectProject(o,t.projects.length-1),t.resetProjectForm()}},t.newProject=function(){t.projectModal.show()},t.closeNewProject=function(){t.projectModal.hide(),t.resetProjectForm()},t.resetProjectForm=function(){t.project={title:""},t.resetForm()},t.submitForm=function(){t.submitted=!0},t.resetForm=function(){t.submitted=!1},t.selectProject=function(e,o){t.activeProject=e,r.setLastActiveIndex(o),c.toggleLeft(!1)},o.fromTemplateUrl("templates/new-task.html",function(e){t.taskModal=e},{scope:t,focusFirstInput:!0}),t.createTask=function(e){t.activeProject&&e&&(t.activeProject.tasks.push({title:e.title}),t.taskModal.hide(),r.save(t.projects),t.resetTaskForm())},t.newTask=function(){t.taskModal.show()},t.closeNewTask=function(){t.taskModal.hide(),t.resetTaskForm()},t.resetTaskForm=function(){t.task={title:""},t.resetForm()},t.toggleProjects=function(){c.toggleLeft()},t.data={},e(function(){0==t.projects.length&&n.show({template:'<input type="text" ng-model="data.title">',title:"Enter Your First Project",scope:t,buttons:[{text:"<b>Create Project</b>",type:"button-positive",onTap:function(e){return t.data.title?void t.createProject({title:t.data.title}):void e.preventDefault()}}]})})}]),function(){function t(t){function e(){r.submitted=!0}function o(e){e&&(t.$broadcast("newProjectSubmitted",e),n())}function c(){t.$broadcast("newProjectClosed",null),n()}function n(){r.project={title:""},r.submitted=!1}var r=this;r.project={title:""},r.submitForm=e,r.submitProject=o,r.closeNewProject=c}angular.module("app").controller("NewProjectController",t),t.$inject=["$rootScope"]}(),function(){function t(t){function e(){r.submitted=!0}function o(e){e&&(t.$broadcast("newTaskSubmitted",e),c())}function c(){r.task={title:""},r.submitted=!1}function n(){t.$broadcast("newTaskClosed",null),c()}var r=this;r.task={title:""},r.submitForm=e,r.submitTask=o,r.closeNewTask=n}angular.module("app").controller("NewTaskController",t),t.$inject=["$rootScope"]}(),function(){function t(t,e,o,c){function n(){f.projects=c.all(),f.activeProject=f.projects[c.getLastActiveIndex()],e.fromTemplateUrl("app/projects/new-project.html",function(t){f.projectModal=t},{focusFirstInput:!0}),e.fromTemplateUrl("app/projects/new-task.html",function(t){f.taskModal=t},{focusFirstInput:!0}),t.$on("newProjectSubmitted",function(t,e){f.createProject(e)}),t.$on("newProjectClosed",function(t,e){f.closeNewProject()}),t.$on("newTaskSubmitted",function(t,e){f.createTask(e)}),t.$on("newTaskClosed",function(t,e){f.closeNewTask()})}function r(){o.toggleLeft()}function a(t,e){f.activeProject=t,c.setLastActiveIndex(e),o.toggleLeft(!1)}function i(){f.projectModal.show()}function s(){f.taskModal.show()}function l(t){var e=c.newProject(t.title);f.projects.push(e),f.projectModal.hide(),c.save(f.projects),f.selectProject(e,f.projects.length-1)}function u(){f.projectModal.hide()}function p(t){f.activeProject&&t&&(f.activeProject.tasks.push({title:t.title}),f.taskModal.hide(),c.save(f.projects))}function j(){f.taskModal.hide()}var f=this;f.task={title:""},f.toggleProjects=r,f.selectProject=a,f.newProject=i,f.newTask=s,f.createProject=l,f.closeNewProject=u,f.createTask=p,f.closeNewTask=j,n()}angular.module("app").controller("ProjectController",t),t.$inject=["$scope","$ionicModal","$ionicSideMenuDelegate","projectService"]}(),function(){function t(t){return{all:function(){var e=t.localStorage.projects;return e?angular.fromJson(e):[]},save:function(e){t.localStorage.projects=angular.toJson(e)},newProject:function(t){return{title:t,tasks:[]}},getLastActiveIndex:function(){return parseInt(t.localStorage.lastActiveProject)||0},setLastActiveIndex:function(e){t.localStorage.lastActiveProject=e}}}angular.module("app").factory("projectService",t),t.$inject=["$window"]}();